import{_ as a,o as s,c as e,O as n}from"./chunks/framework.fb7bb97b.js";const l="/G-blog/assets/java版本.7543394a.png",v=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"webDeveloper/app/taro分离模式开发app(环境安装).md","filePath":"webDeveloper/app/taro分离模式开发app(环境安装).md","lastUpdated":1688625941000}'),t={name:"webDeveloper/app/taro分离模式开发app(环境安装).md"},o=n(`<h2 id="taro-分离模式开发-app-环境安装" tabindex="-1">taro 分离模式开发 app(环境安装) <a class="header-anchor" href="#taro-分离模式开发-app-环境安装" aria-label="Permalink to &quot;taro 分离模式开发 app(环境安装)&quot;">​</a></h2><h3 id="_1-官方文档" tabindex="-1">1. 官方文档 <a class="header-anchor" href="#_1-官方文档" aria-label="Permalink to &quot;1. 官方文档&quot;">​</a></h3><ul><li>taro React Native 开发流程 <a href="https://docs.taro.zone/docs/react-native/#%E9%85%8D%E7%BD%AE-output" target="_blank" rel="noreferrer">https://docs.taro.zone/docs/react-native/#配置-output</a></li><li>React Native 环境配置 <a href="https://reactnative.cn/docs/next/environment-setup" target="_blank" rel="noreferrer">https://reactnative.cn/docs/next/environment-setup</a></li></ul><h3 id="_2-taro-安装" tabindex="-1">2. Taro 安装 <a class="header-anchor" href="#_2-taro-安装" aria-label="Permalink to &quot;2. Taro 安装&quot;">​</a></h3><ul><li>官方参考文档 <a href="https://docs.taro.zone/docs/GETTING-STARTED" target="_blank" rel="noreferrer">https://docs.taro.zone/docs/GETTING-STARTED</a></li><li>安装 Node.js，推荐使用 Node.js 12.0 及以上版本。</li><li>安装 Taro 开发工具 @tarojs/cli</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 使用 npm 安装 CLI</span></span>
<span class="line"><span style="color:#A6ACCD;">  $ npm install -g @tarojs/cli</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">  # OR 使用 yarn 安装 CLI</span></span>
<span class="line"><span style="color:#A6ACCD;">  $ yarn global add @tarojs/cli</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">  # OR 安装了 cnpm，使用 cnpm 安装 CLI</span></span>
<span class="line"><span style="color:#A6ACCD;">  $ cnpm install -g @tarojs/cli</span></span></code></pre></div><ul><li>通过 taro init 选择任意模板生成</li></ul><h3 id="_3-java-环境安装" tabindex="-1">3. java 环境安装 <a class="header-anchor" href="#_3-java-环境安装" aria-label="Permalink to &quot;3. java 环境安装&quot;">​</a></h3><ul><li>首先需要有 java 环境，可以通过 javac -version 查看是否安装，需要注意安装版本,这个是重点，敲黑板 <img src="`+l+`" alt="java版本"></li><li>安装包 <a href="https://www.oracle.com/java/technologies/downloads/#java11" target="_blank" rel="noreferrer">https://www.oracle.com/java/technologies/downloads/#java11</a></li><li>java 环境变量配置 <a href="https://blog.csdn.net/weixin_44778232/article/details/124610021" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_44778232/article/details/124610021</a></li></ul><h3 id="_4-android-studio-安装" tabindex="-1">4. Android Studio 安装 <a class="header-anchor" href="#_4-android-studio-安装" aria-label="Permalink to &quot;4. Android Studio 安装&quot;">​</a></h3><ul><li>下载路径 <a href="https://developer.android.google.cn/studio/" target="_blank" rel="noreferrer">https://developer.android.google.cn/studio/</a></li><li>具体教程 <a href="https://reactnative.cn/docs/next/environment-setup" target="_blank" rel="noreferrer">https://reactnative.cn/docs/next/environment-setup</a></li><li>教程需要完成到配置环境变量 Path 即可</li></ul><h3 id="_5-fork-壳工程-taro-native-shell" tabindex="-1">5. fork 壳工程 taro-native-shell <a class="header-anchor" href="#_5-fork-壳工程-taro-native-shell" aria-label="Permalink to &quot;5. fork 壳工程 taro-native-shell&quot;">​</a></h3><ul><li>项目地址 <a href="https://github.com/NervJS/taro-native-shell" target="_blank" rel="noreferrer">https://github.com/NervJS/taro-native-shell</a></li><li>将壳工程的 android 文件夹在 Android Studio 中打开，然后在 Android Studio 中打开，Android Studio 会自动下载相关依赖和 sdk 等</li><li>运行 Android Studio 中的模拟器</li></ul><h3 id="_6-修改-taro-项目中的-config-index-js-指定资源输出目录" tabindex="-1">6. 修改 Taro 项目中的./config/index.js 指定资源输出目录 <a class="header-anchor" href="#_6-修改-taro-项目中的-config-index-js-指定资源输出目录" aria-label="Permalink to &quot;6. 修改 Taro 项目中的./config/index.js 指定资源输出目录&quot;">​</a></h3><ul><li>具体的路径需要根据自己的项目路径来配置</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    rn: {</span></span>
<span class="line"><span style="color:#A6ACCD;">      output: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        iosSourceMapUrl: &#39;&#39;, // sourcemap 文件url</span></span>
<span class="line"><span style="color:#A6ACCD;">        iosSourcemapOutput: &#39;../taro-native-shell/ios/main.map&#39;, // sourcemap 文件输出路径</span></span>
<span class="line"><span style="color:#A6ACCD;">        iosSourcemapSourcesRoot: &#39;&#39;, // 将 sourcemap 资源路径转为相对路径时的根目录</span></span>
<span class="line"><span style="color:#A6ACCD;">        androidSourceMapUrl: &#39;&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        androidSourcemapOutput: &#39;../taro-native-shell/android/app/src/main/assets/index.android.map&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        androidSourcemapSourcesRoot: &#39;&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        ios: &#39;../taro-native-shell/ios/main.jsbundle&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        iosAssetsDest: &#39;../taro-native-shell/ios&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        android: &#39;../taro-native-shell/android/app/src/main/assets/index.android.bundle&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">        androidAssetsDest: &#39;../taro-native-shell/android/app/src/main/res&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">      },</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span></code></pre></div><ul><li>在 Taro 项目中运行</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 启动 bundle server</span></span>
<span class="line"><span style="color:#A6ACCD;">$ yarn dev:rn</span></span></code></pre></div><ul><li>在壳工程中运行</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 更新相关依赖。Taro 版本更新后执行，用于同步 peerDependencies。</span></span>
<span class="line"><span style="color:#A6ACCD;">$ yarn upgradePeerdeps</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># 启动安卓</span></span>
<span class="line"><span style="color:#A6ACCD;">$ yarn android</span></span></code></pre></div><h3 id="_7-遇到的问题" tabindex="-1">7. 遇到的问题 <a class="header-anchor" href="#_7-遇到的问题" aria-label="Permalink to &quot;7. 遇到的问题&quot;">​</a></h3><ul><li><p>报错：error Failed to install the app. Make sure you have the Android development 解决方案：<a href="https://www.jianshu.com/p/e4abcaf3aab3" target="_blank" rel="noreferrer">https://www.jianshu.com/p/e4abcaf3aab3</a> 尝试后无果，查看安卓文件夹下的 local.properties 中 dir 为 C:\\Users\\EDY\\AppData\\Local\\Android\\Sdk 和大部分在百度上的文章不同 Sdk 为小写，修改为小写后重新运行解决问题，但本地的路径确实是 Sdk 大写的,此问题很可能还是和 java 版本有关，后面修改为 java 11 后修改为 Sdk 大写后也可以运行了</p></li><li><p>报错：react-native ＜ 0.69 Exceptions.h:5:10: fatal error: ‘fbjni/fbjni.h‘ file not found 解决方案：<a href="https://blog.csdn.net/weixin_42368597/article/details/127442626?spm=1001.2014.3001.5501" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_42368597/article/details/127442626?spm=1001.2014.3001.5501</a></p></li><li><p>在 Taro 中使用 vue 框架构建，Taro 暂不支持 vue 编译为安卓和 ios 打包最终会显示 500 <a href="https://github.com/NervJS/taro/issues/13240" target="_blank" rel="noreferrer">https://github.com/NervJS/taro/issues/13240</a></p></li><li><p>安装上应用后闪退</p></li><li><p>查看 logcat 日志，发现是堆栈报错了， fault addr 0x0 in tid 10786 (mqt_js), pid 10722</p></li><li><p>猜测和之前的报错有关</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">BUILD FAILED in 6s</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">error Failed to install the app. Make sure you have the Android development environment set up: https://reactnative.dev/docs/environment-setup. Run CLI with --verbose flag for more details.</span></span>
<span class="line"><span style="color:#A6ACCD;">Error: Command failed: ./gradlew app:installDebug -PreactNativeDevServerPort=8081</span></span>
<span class="line"><span style="color:#A6ACCD;">java.lang.NoClassDefFoundError: Could not initialize class org.codehaus.groovy.vmplugin.v7.Java7</span></span></code></pre></div></li><li><p>并且无法通过 Android Studio 或命令行 运行到真机上，也无法使用命令行 正常启动项目在模拟器。</p></li><li><p>解决方案第三点：<a href="https://www.jianshu.com/p/851d76c2754e" target="_blank" rel="noreferrer">https://www.jianshu.com/p/851d76c2754e</a></p></li><li><p>因为我安装的 java 版本不对，需要安装 11，我安装了 17 导致的，所以需要卸载 17，安装 11，然后配置环境变量，再次运行，成功运行到</p></li></ul>`,22),r=[o];function i(p,c,d,h,u,A){return s(),e("div",null,r)}const m=a(t,[["render",i]]);export{v as __pageData,m as default};
